<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>GhPython | IDEA StatiCa API </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="GhPython | IDEA StatiCa API ">
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      
      
      
      <meta name="docfx:docurl" content="https://github.com/idea-statica/ideastatica-public/blob/add_wiki_content_to_docfx/docfx_project/docs/api/python/api_using_api_in_grasshopper.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
  </head>

  <script type="module">
    import options from './../../../public/main.js'
    import { init } from './../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" class="svg" src="../../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">

<p>Grasshopper is a great way to utilize the IDEA StatiCa API to perform optimization and retrieve connection results. Any of the scripting components available in out-of-the-box grasshopper can be used to Automate IDEA through the API.</p>
<p><img src="https://github.com/idea-statica/ideastatica-public/blob/main/docs/Images/wiki/gh_scripting_components.png" alt="Grasshopper scripting components"></p>
<p>As most of the output that is provided by the API can be serialized or represented in a JSON format it is easy to retrieve output by using available plug-ins in Grasshopper. <a href="https://www.food4rhino.com/en/app/jswan">jSwan</a> is a great plugin for working with JSON strings.</p>
<h2 id="ghpython">GhPython</h2>
<p>GhPython is a powerful scripting component that allows a user to run python code within Grasshopper. Most of the Python examples provided should work when used inside GhPython.</p>
<p>The example code below provides an example of how an IDEA Connection file can be run and the bolt forces extracted using GhPython. jSwan is then used to filter specific results from the JSON output.</p>
<p><img src="https://github.com/idea-statica/ideastatica-public/blob/main/docs/Images/wiki/gh_scripting_python_complete.png" alt="bolt forces"></p>
<p>Copy and paste the following code into a GhPython component. Note: The trigger component is used to stop the component from running consistently as calculation may take some time.</p>
<p><img src="https://github.com/idea-statica/ideastatica-public/blob/main/docs/Images/wiki/gh_scripting_python.png" alt="bolt forces code"></p>
<p>Before running the script:</p>
<ul>
<li>Change the <code>ideaCon_filename</code> to a prepared .ideaCon file which has some bolts in it. Make sure the Connection file is located in the same folder as the Grasshopper script and the grasshopper script is saved. The GH script is used to find the file automatically.</li>
</ul>
<pre><code class="lang-python">
&quot;&quot;&quot;Provides a scripting component.
    Inputs:
        x: The x script variable
        y: The y script variable
    Output:
        a: The a output variable&quot;&quot;&quot;

__author__ = &quot;NathanLuke&quot;
__version__ = &quot;2022.04.12&quot;

import Grasshopper as gh
import rhinoscriptsyntax as rs
import clr
import sys
import json
import math
import os

# the path to the idea connection installation directory
idea_path = r&quot;C:\Program Files\IDEA StatiCa\StatiCa 21.1&quot;

# modify path to be able to load .net assemblies
sys.path.append(idea_path)

# load the assembly IdeaStatiCa.Plugin which is responsible for communication with IdeaStatiCa 
clr.AddReference('IdeaStatiCa.Plugin')
from IdeaStatiCa.Plugin import ConnHiddenClientFactory

# find the directory of this script to fetch idea file.
ghfilepath = ghenv.LocalScope.ghdoc.Path
script_dir = os.path.dirname(ghfilepath)

# the name of idea connection project which is used in this script
ideaCon_filename = r&quot;BoltResultTest.ideaCon&quot;

connection_project_path = os.path.join(script_dir, ideaCon_filename) 

# create the instance of the client which communicates with IdeaStatiCa
factory = ConnHiddenClientFactory(idea_path)
ideaConnectionClient = factory.Create()

# open idea connection project 
ideaConnectionClient.OpenProject(connection_project_path)

# get information about connections in the project and print them
projectInfo = ideaConnectionClient.GetProjectInfo()
connections = projectInfo.Connections

for conn in connections:
    print(f'{conn.Name} { conn.Identifier}')

# Get Connection Info of First Connection in file
firstCon = connections[0]

# Runs Calculation
briefResults = ideaConnectionClient.Calculate(firstCon.Identifier)

# Get Detailed Results Info of the check of the first connection
checkResults_json_string = ideaConnectionClient.GetCheckResultsJSON(firstCon.Identifier)

#Convert Result to JSON
pyJSON = json.loads(checkResults_json_string)

#Find Bolt Results
boltJSON = pyJSON['bolts']

#Return Bolt Results to GhPython Component Output Parameter
a = json.dumps(boltJSON, indent = 4)

# Close idea connection project
ideaConnectionClient.CloseProject()
ideaConnectionClient.Close()

</code></pre>
</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/idea-statica/ideastatica-public/blob/add_wiki_content_to_docfx/docfx_project/docs/api/python/api_using_api_in_grasshopper.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>


    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>